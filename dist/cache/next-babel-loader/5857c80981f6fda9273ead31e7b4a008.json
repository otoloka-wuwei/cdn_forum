{"ast":null,"code":"const timeoutMap = {};\n\nconst postMessageToApp = function postMessageToApp({\n  action,\n  data = {},\n  timeout = 1000\n}) {\n  try {\n    return Promise.resolve(new Promise((resolve, reject) => {\n      const callBackName = 'ReactNativeWebviewCallBack' + ~~(Math.random() * 100000) + '' + ~~(Math.random() * 100000) + '' + new Date().getTime();\n      const postData = Object.assign({}, data, {\n        callback: callBackName\n      });\n      timeoutMap[callBackName] = false;\n      const timer = setTimeout(() => {\n        timeoutMap[callBackName] = true;\n        reject('post message to app timeout,please check action');\n      }, timeout);\n\n      window[callBackName] = result => {\n        window[callBackName] = null;\n        clearTimeout(timer);\n\n        if (timeoutMap[callBackName] === true) {\n          return;\n        }\n\n        resolve(result);\n      };\n\n      window.ReactNativeWebView.postMessage(JSON.stringify({\n        action,\n        data: postData\n      }));\n    }));\n  } catch (e) {\n    return Promise.reject(e);\n  }\n};\n\nexport default postMessageToApp;","map":null,"metadata":{},"sourceType":"module"}